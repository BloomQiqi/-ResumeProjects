{"version":3,"sources":["assets\\Script\\ThirdPage\\onButtonClick.js"],"names":["cc","Class","Component","properties","button","Button","start","parent","node","getParent","getComponent","OnClick","index","getSiblingIndex","log","isFront","normalSprite","garbagePhoto","garbageIndex","hoverSprite","garbageNameLabel","string","name","playMusicClips","isRight","rightLeftNum","popUpPassLevel","particleSmokeFlower","resetSystem","errorNum","n","scheduleOnce","textTipLabel","error3","garbagePhotoBackGround","erroring3flag","erroring3Count","PopUpPage","life","errorGarbagePhoto","changeLifeSprite","popUpNotPassLevel","resetInteractable","i","length","isInteractable","children","interactable","setTextLabelTip1Callback","setTextLabelDefCallback","tipPhoto","tipKnowledgeNode","popupPage2"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        button:cc.Button,\r\n    },\r\n    start(){\r\n        this.parent = this.node.getParent().getComponent(\"Initate\");\r\n        //cc.log(this.parent);\r\n        // this.node.on('touchstart',this.OnClick(),this);\r\n    },\r\n\r\n    OnClick(){\r\n       //  cc.log(this.parent);\r\n       // cc.log(this.parent.levelNum);////////////////////////////////////////////////////////////////////////// \r\n        \r\n        var index = this.node.getSiblingIndex();//获取索引 到底是父节点的那一个子节点被点击\r\n        //判断当前block 处于背景图还是垃圾图\r\n        cc.log(\"index \"+index);\r\n\r\n        if(this.parent.isFront[index]) //当前处于背景图\r\n        {\r\n            this.parent.isFront[index] = false;\r\n\r\n            this.button.normalSprite = this.parent.garbagePhoto[this.parent.garbageIndex[index]];//切换button背景图片为垃圾图片\r\n            this.button.hoverSprite = this.parent.garbagePhoto[this.parent.garbageIndex[index]];\r\n            \r\n           // cc.log(this.parent.garbagePhoto[this.parent.garbageIndex[index]]);\r\n            this.parent.garbageNameLabel.string = this.parent.garbagePhoto[this.parent.garbageIndex[index]].name;\r\n\r\n            //this.parent.playMusicClips(this.parent.isRight[index]);   //播放音效   第一张方式\r\n            this.parent.playMusicClips();\r\n           \r\n           if(this.parent.isRight[index])\r\n           {\r\n               \r\n               if(--this.parent.rightLeftNum==0)      /////////////成功通关！  可能更改条件\r\n               {\r\n                    this.parent.popUpPassLevel();\r\n                    this.parent.particleSmokeFlower.resetSystem();\r\n               }\r\n           }\r\n           else   //isFront = true && isRight =false \r\n           {\r\n              //翻出了错误的block              \r\n               if(++this.parent.errorNum>=this.parent.n)  //提示 已错3个\r\n               {\r\n                   this.scheduleOnce(function(){\r\n                    this.parent.textTipLabel.string = '您以翻错了3个，请翻回！';\r\n                   },0.01);\r\n                   this.scheduleOnce(function(){\r\n                    this.parent.textTipLabel.string = '';\r\n                   },6);\r\n                   this.error3();           //修改交互性 初始化此状态的变量     \r\n               }\r\n           }\r\n\r\n           \r\n\r\n           cc.log('剩余正确的：'+this.parent.rightLeftNum+' 当前已翻错：'+this.parent.errorNum);\r\n        }\r\n        else  //翻回已翻开的block\r\n        {\r\n\r\n            this.parent.isFront[index] = true;\r\n            this.button.normalSprite = this.parent.garbagePhotoBackGround;//切换button背景图片为默认背景图片   默认背景图片总是放在最后一个\r\n            this.button.hoverSprite= this.parent.garbagePhotoBackGround;//切换button背景图片为默认背景图片   默认背景图片总是放在最后一个\r\n\r\n\r\n           if(this.parent.isRight[index])\r\n           {\r\n               this.parent.rightLeftNum++;//剩余正确的block 加一\r\n           }\r\n           else   //isFront = false && isRight =false  \r\n           {\r\n               this.parent.errorNum--;//翻回了翻错误的block  \r\n           }\r\n\r\n           if(this.parent.erroring3flag)  //如果处于改错状态\r\n           {\r\n               if(--this.parent.erroring3Count == 0)//改错状态翻回次数已用完\r\n               {\r\n                   this.parent.erroring3flag=false;    //结束改错状态\r\n                   if(this.parent.errorNum>=2)   //至多找回了一个翻错的block\r\n                   {\r\n                       //\r\n                       this.PopUpPage();//弹出知识小提示  呼吸动画效果\r\n\r\n                       --this.parent.life;\r\n                       \r\n                       errorGarbagePhoto = this.parent.garbagePhoto[this.parent.garbageIndex[index]];  //此变量用于 和知识小提示图片进行交互\r\n\r\n                       this.parent.changeLifeSprite();\r\n                       //this.parent.lifeLabel.string = \"Life:\"+this.parent.life;\r\n                       if(this.parent.life==0)      //生命值减一           ////////////////////////////////////////////提示标志未加！\r\n                       {\r\n                            //parent.textTipLabel.string = \"生命值为0！！！闯关失败\" ;    //使用计时器                            //////////////////////关卡结束  后期可以改成弹窗或者一个动画\r\n                            //更新life\r\n                            this.parent.popUpNotPassLevel();  //弹出关卡失败界面\r\n                       }                          \r\n                   } \r\n                   //重设isInteractable[i]   所有的皆可交互了()\r\n                   this.resetInteractable();\r\n               }\r\n           }\r\n           cc.log('剩余正确的：'+this.parent.rightLeftNum+' 当前已翻错：'+this.parent.errorNum);\r\n        }\r\n        \r\n    },\r\n\r\n    error3(){  //当前翻错超过3个  改变交互性\r\n        this.parent.erroring3flag = true; \r\n        this.parent.erroring3Count = 3;    //有3次翻回的机会  \r\n        \r\n        for(var i = 0;i < this.parent.garbageIndex.length;i++ )\r\n        {\r\n            if(this.parent.isFront[i])  //如果未翻开则不能翻开   \r\n            {\r\n                this.parent.isInteractable[i] = false;\r\n                this.node.parent.children[i].getComponent(cc.Button).interactable = this.parent.isInteractable[i];      \r\n            }\r\n        }\r\n    },\r\n    resetInteractable()           //重设isInteractable[i]\r\n    {\r\n        for(var i = 0;i < this.parent.garbageIndex.length;i++ )\r\n        {    \r\n            this.parent.isInteractable[i] = true;\r\n            this.node.parent.children[i].getComponent(cc.Button).interactable = this.parent.isInteractable[i];             \r\n        }\r\n    },\r\n    //未调用\r\n    setTextLabelTip1Callback(){   //滚动提示                  ////////////////////////////////////////////设置滚动提示       \r\n        this.parent.textTipLabel.string = '您以翻错了3个，请翻回！';\r\n    },\r\n    setTextLabelDefCallback(){   //设提示文字label 为默认状态\r\n        this.parent.textTipLabel.string = \"\";\r\n    },\r\n    // update (dt) {},\r\n\r\n    PopUpPage(){\r\n        var tipPhoto=this.parent.tipKnowledgeNode.getComponent(\"tipPhoto\");\r\n        tipPhoto.popupPage2();\r\n\r\n        // cc.find(\"Canvas\").pauseSystemEvents(true);\r\n        // node1.on(\"touchstart\",event=>{    \r\n        //     this.upFlag = false;\r\n        //     cc.log(\"销毁了一个\");\r\n        //     node1.destroy();\r\n        //     cc.find(\"Canvas\").resumeSystemEvents(true);\r\n        // },this);\r\n\r\n    }\r\n});\r\n\r\n\r\n"]}